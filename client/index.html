  <!-- Runtime swap: nahradí media v kartě "Live AI Avatar Demo" videem (robust verze) -->
  <script>
    (function () {
      var VIDEO_SRC = '/videos/Generativni_ai.mp4';

      function buildVideo() {
        var wrap = document.createElement('div');
        wrap.className = 'aspect-video overflow-hidden rounded-2xl';
        var v = document.createElement('video');
        v.src = VIDEO_SRC;
        v.autoplay = true;
        v.muted = true;
        v.loop = true;
        v.playsInline = true;
        v.preload = 'metadata';
        v.className = 'h-full w-full object-cover';
        wrap.appendChild(v);
        return wrap;
      }

      function findCard() {
        // Najdi heading
        var headings = Array.from(document.querySelectorAll('h1,h2,h3,h4'));
        var target = headings.find(function (h) {
          return (h.textContent || '').replace(/\s+/g,' ').trim().toLowerCase() === 'live ai avatar demo';
        });
        if (!target) return null;
        // Vyber nejbližší větší kontejner (dvě úrovně nahoru obvykle drží card)
        var card = target.closest('div');
        // V některých layoutech je card o úroveň výš
        if (card && card.parentElement && card.parentElement.querySelector && card.parentElement.querySelector('h3') === target) {
          card = card.parentElement;
        }
        return card || null;
      }

      function swap() {
        var card = findCard();
        if (!card) return false;

        // 1) zkus nahradit IMG v rámci karty
        var img = card.querySelector('img');
        if (img && img.parentElement) {
          img.parentElement.replaceWith(buildVideo());
          return true;
        }

        // 2) zkus nahradit existující video/placeholder wrapper
        var media = card.querySelector('.aspect-video, [data-media], picture');
        if (media && media.parentElement) {
          media.parentElement.replaceChild(buildVideo(), media);
          return true;
        }

        // 3) fallback – vlož video na začátek card
        card.insertBefore(buildVideo(), card.firstChild);
        return true;
      }

      function runWithRetries() {
        var tries = 0;
        var maxTries = 12; // cca 6 s celkem
        (function tick(){
          if (swap()) return;
          if (++tries >= maxTries) return;
          setTimeout(tick, 500);
        })();
      }

      if (document.readyState === 'complete' || document.readyState === 'interactive') {
        runWithRetries();
      } else {
        document.addEventListener('DOMContentLoaded', runWithRetries);
      }

      // Navíc sleduj mutace pro případ pozdější hydratace
      var mo = new MutationObserver(function () {
        swap();
      });
      mo.observe(document.documentElement, { childList: true, subtree: true });
      setTimeout(function(){ try { mo.disconnect(); } catch(e){} }, 8000);
    })();
  </script>